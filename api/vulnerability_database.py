# API interface to NIST National Vulnerability Database
# fetches most recent published data available on website (updated daily)
# objects are inserted into a mongodb instance, defined in the database module

import api.download as download
import api.fetch as fetch
import api.insert as insert

# downloads, parses, and inserts the most recent NVD vulnerabilities into the local db
def update_recent():
	file = download.recent()
	objects = download.to_json(file)
	insert.group(objects)

# downloads, parses, and inserts the most recently updated 'modified' NVD vulnerabilities list into the local db
def update_modified():
	file = download.modified()
	objects = download.to_json(file)
	insert.group(objects)

# downloads, parses, and inserts most recently updated list of NVD vulnerabilities for a given year
def update_year(year):
	file = download.year(year)
	objects = download.to_json(file)
	insert.group(objects)

# opens a local file and inserts the NVD vulnerabilities into the local db
def update_local(filename):
	file = download.from_local(filename)
	objects = download.to_json(file)
	insert.group(objects)

